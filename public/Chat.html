<html lang="no">
    <head>
    <title>Chat</title>
        <meta charset="UTF-8"/>
        <link href="./Assets/Chatlogo.png" rel="icon"/>
        <link href="Styles.css" rel="Stylesheet" type="text/css">

        <style> 
            input[type=text] {
              
              padding: 12px 20px;
              margin: 8px 0;
              border-radius: 20px;
              box-sizing: border-box;
              border: 1px solid #d9d9d9;
              outline: none;
              -webkit-font-smoothing: antialiased;
              font-size: 12pt;
              color: #4d4d4d;
            }
            input[type=text]:focus {
            border: 1px solid #bccea0;
            }
            ::placeholder{
                -webkit-font-smoothing:antialiased;
                color: #4d4d4d;
                font-family: 'Noto Sans', Sans-Serif;
                opacity: 0.8;
                font-size: 12pt;
            }
        </style>
        <script>
            src="https://code.jquery.com/jquery-3.5.1.min.js"
            integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
            crossorigin="anonymous">
        </script>
    </head>
    <body>
        
        <div id="Container">

            <div id="Contacts">
                <div id="Name2">
                    <input type="text" placeholder="Create nickname" name="Nickname" class="inputStyle">
 
                </div>
                <div id="Contact">
                    <p id="user">manuxd</p>
                    <p id="lastSaid">Kom smash bros hvis ikke skal jeg spise</p>
                    <p id="time">24 minutes ago</p>
                </div>
                <div id="Contact">
                    <p id="user">Kardo</p>
                    <p id="lastSaid">Jeg er bedre enn deg i sjakk wallahz</p>
                    <p id="time">1 hour ago</p>
                </div>
            </div>
            <div id="Chatbox">
                <div id="Name">
                    <h2 style="padding:0px 20;">Create a nickname to get started</h2>
                </div>
                
                <div id="Messages">
                    
                    <div id="mine">
                        <div class="message-text">omg sant det jeg har ikke test aut dette engang lmao jaja vi får se
                            <em class="message-time">11:45</em>
                        </div>
                    </div>

                    <div id="theirs">
                        <div class="message-text">Så liksom visste du da at det går an å velge masse forskjellige karaktererer i smash bros, altså at det ikke bare er en men mange flere? Oje med pero dale la cono todo la via aiaiaiai
                            <em class="message-time">10:20</em>
                        </div>
                    </div>
                    <div id="theirs">
                        <div class="message-text">ja haha bra jobba gg bro no cap
                            <em class="message-time">10:20</em>
                        </div>
                    </div>
                    
                </div>

                <div id="inputField">
                    <div id="typeMessage">
                        <input type="text" placeholder="Say something nice" name="Chat" action="" method="POST" class="bigInput">
                    </div>

                    <div id="button">
                        <p class="sendText"><strong>Send</strong></p>
                    </div>
                </div>
            </div>
        </div>

        <script>
            $(document).on('keypress',function(e) {
                if(e.which == 13) {
                    createServer()
                }
            });

            function createServer(){
                console.log("created server" );
            }
        </script>


	<script>
		$(document).ready(function(){
			loadChat();
		});
		
		$('#message').keyup(function(e){
			var message = $(this).val();
			if( e.which == 13 ){
				$.post('handlers/ajax.php?action=SendMessage&message='+message, function(response){
					
					loadChat();
					$('#message').val('');
				});
			}
		});
		function loadChat()
		{
			$.post('handlers/ajax.php?action=getChat', function(response){
				
				$('.chathistory').html(response);
			});
		}
		setInterval(function(){
			loadChat();
		}, 2000);
	</script>
    <script src="./public/main.js"></script>

    </body>
</html>

<!-- const http = require("http") // For web
var url = require('url'); // Ser viktig ut
const fs = require("fs") // For å lese filer
const port = 4000 // Porten den skal tjene
var path = require('path'); // Ser viktig ut 


const server = http.createServer(function(req, res){ // Selve serveren
    res.writeHead(200, {"Content-Type": "text/css"});
    res.writeHead(200, { "Content-Type": "text/html" })
    fs.readFile("Chat.html", function(error, data){
        if (error){
            res.writeHead(404)
            res.write("Error: File Not Found")
        }
        else{
            res.write(data)
        }
        res.end()
    })

})

server.listen(port, function(error){ // Forteller om alt gikk bra i terminalen
    if (error){
        console.log("Something went wrong", error) // Viser hvor feilen er
    } else{
        console.log("Server is listening on port " + port)
    }
}) -->